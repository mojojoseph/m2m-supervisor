#!/usr/bin/env node

var RedisCheckpoint = require('../services/redis-checkpoint');
var ConfigCheckpoint = require('../services/config-checkpoint');
var QueueRouter = require('../services/queue-router');

var hashkeys = require('../lib/config-hashkeys');

var redisChk = new RedisCheckpoint().start(function(event,redis) {
    if (event !== 'ready') return;

    var configChk = new ConfigCheckpoint(redis,hashkeys.gateway,[hashkeys.gateway.imei.key]).start(function(event,gateway) {
        if (event !== 'ready') return;

        var router = new QueueRouter(redis,null,gateway).start();
    });
});


