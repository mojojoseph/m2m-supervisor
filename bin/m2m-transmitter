#!/usr/bin/env node

var RedisCheckpoint = require('../services/redis-checkpoint');
var ConfigCheckpoint = require('../services/config-checkpoint');
var M2mTransmitter = require('../services/m2m-transmitter');

var hashkeys = require('../lib/config-hashkeys');

var redisChk = new RedisCheckpoint().start(function(event,redis) {
    if (event !== 'ready') return;

    var configChk = new ConfigCheckpoint(redis,hashkeys.gateway,[hashkeys.gateway.imei.key]).start(function(event,gateway) {
        if (event !== 'ready') return;

        var transmitter = new M2mTransmitter(redis,gateway).start();
    });
});


